---
title: "C3_Academic_Experiences"
editor: visual
---

This is a chapter about academic outcomes at UCSD


```{r}
#| label: run_scripts
#| include: FALSE

source("rscripts/load_packages.R", local = knitr::knit_global())

source("rscripts/functions_clean_data.R" ,local = knitr::knit_global())

source("rscripts/functions_visualize.R" ,local = knitr::knit_global())

```

```{r}
caption_ug<-"Source: UCUES 2022, UC Infocenter"
caption_grad<-"Source: GSES 2021 UC Infocenter"
```


```{r}
#ucues
es<- read_excel("data/ucues_2022_rebuild.xlsx")%>%
  label_groups(.)

gses<-read_excel("data/UCGSES.xlsx")%>%
  label_groups(.)

```


## Undergraduates

### Overall Academic Experience
```{r}
overallac_2022<-es%>%
filter(q=="Overall academic experience"&year=="2022")%>%
 clean_vibe_satisfied(.)%>%
  collapse_negative_vibe(.)%>%
   mutate(all=filter(., comp=="All")%$% value)%>%
  create_diff_cols(.)%>%
  #low sample size
  filter(group_label!="All"& group_label!="American Indian")

plot_group_comp(overallac_2022, cols_neg)%>%
  plot_diff_rect(., overallac_2022, .06,.21,"Less Dissatisfied", "More Dissatisfied")+
  labs(title="Overall Academic Experience",
         caption=caption_ug,
      subtitle = "Percent of UCSD UG who are somewhat dissatisfied, dissatisfied, or very dissatisfied")

 ggsave("viz/acex/overall_ac_ex2022.png", width=9, height=5, units="in", dpi=300)
 
```

```{r}
fac_diff_2022<- read_excel("data/ucues_2022_rebuild.xlsx")%>%
  filter(q=="Faculty are genuinely committed to promoting respect for and understanding of group differences at UC")%>%
  label_groups(.)%>%
  clean_vibe_agree(.)%>%
  collapse_negative_vibe(.)%>%
   mutate(all=filter(., comp=="All")%$% value)%>%
  create_diff_cols(.)%>%
  filter(group_label!="All"& group_label!="American Indian")

plot_group_comp(fac_diff_2022, cols_neg)%>%
  plot_diff_rect(., fac_diff_2022, .06,.23,"Less Disagreement", "More Disagreement")+
  labs(title="Faculty are genuinely committed to promoting respect for and understanding of group differences at UCSD",
         caption=caption_ug,
      subtitle = "Percent of UCSD UG who somewhat disagree, disagree, or strongly disagree")

 ggsave("viz/acex/fac_diff_2022.png", width=9, height=5, units="in", dpi=300)
```

## Graduate Students

### Quality of Teaching in Program

```{r}
teaching_qual_2021<-gses%>%
  filter(q=="Quality of teaching in your program")%>%
  clean_vibe_rate(.)%>%
  collapse_negative_vibe(.)%>%
    mutate(all=filter(., comp=="All")%$% value)%>%
  create_diff_cols(.)%>%
  filter(group_label!="All"& group_label!="Hispanic/Latinx"&group_label!="African American")


plot_group_comp(teaching_qual_2021, cols_neg)%>%
  plot_diff_rect(., teaching_qual_2021, .07,.25,"Less Low Ratings", "More Low Ratings")+
  labs(title="Quality of teaching in your program",
         caption=caption_grad,
      subtitle = "Percent of UCSD students who rate teaching fair, poor, or very poor")

 ggsave("viz/acex/teaching_qual_2021.png", width=9, height=5, units="in", dpi=300)

```


```{r}

fac_inc_2021<-gses%>%
  filter(q=="I feel included by... the faculty")%>%
  clean_vibe_agree(.)%>%
  collapse_negative_vibe(.)%>%
   mutate(all=filter(., comp=="All")%$% value)%>%
  create_diff_cols(.)%>%
  filter(group_label!="All"& group_label!="Hispanic/Latinx"&group_label!="African American")


plot_group_comp(fac_inc_2021, cols_neg)%>%
  plot_diff_rect(., fac_inc_2021, .08,.21,"Less Disagreement", "More Disagreement")+
  labs(title="I feel included by the faculty",
         caption=caption_grad,
      subtitle = "Percent of UCSD students somewhat disagree, disagree, or strongly disagree")

 ggsave("viz/acex/fac_inc_2021.png", width=9, height=5, units="in", dpi=300)

```


```{r}
fac_cul_2021<-gses%>%
  filter(q=="my culture is respected by... the faculty")%>%
  clean_vibe_agree(.)%>%
  collapse_negative_vibe(.)%>%
   mutate(all=filter(., comp=="All")%$% value)%>%
  create_diff_cols(.)%>%
  filter(group_label!="All"& group_label!="Hispanic/Latinx"&group_label!="African American")

plot_group_comp(fac_cul_2021, cols_neg)%>%
  plot_diff_rect(., fac_cul_2021, .045,.13,"Less Disagreement", "More Disagreement")+
  labs(title="My culture is respected by the faculty",
         caption=caption_grad,
      subtitle = "Percent of UCSD students somewhat disagree, disagree, or strongly disagree")

 ggsave("viz/acex/fac_cul_2021.png", width=9, height=5, units="in", dpi=300)
```



## Response Rates
#### UCUES
```{r}
ug_rr<-es%>%
  filter(q=="Overall academic experience"|q=="Faculty are genuinely committed to promoting respect for and understanding of group differences at UC")%>%
  filter(year=="2022")%>%
  group_by(q,comp,group_label)%>%
  summarise(N=sum(N, na.rm=T))

gt_ug_rr<- gt(ug_rr)
 
gt_ug_rr
```

